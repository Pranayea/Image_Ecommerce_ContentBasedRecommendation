{% extends 'index.html' %}

{% block content %}
{% include 'nav-bar.html' %}

<div class="col-md-8">
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{message}}</div>
      {% endfor %}
    {% endif %}
  </div>

<form action="{% url 'posts:search' %}" method="get">
  <div class="search-bar"> 
    <input name="q" type="text" placeholder="Search..." value="{{query}}"><button type="submit"><i class="bi bi-search"></i></button>
  </div>

  <div class="sort-filter">
    <select name="sorting">
        <option value="-date"{% if sorting == '-date' %} selected{% endif %}>Latest</option>
        <option value="date"{% if sorting == 'date' %} selected{% endif %}>Oldest</option>
        <option value="price"{% if sorting == 'price' %} selected{% endif %}>Price Low to High</option>
        <option value="-price"{% if sorting == '-price' %} selected{% endif %}>Price High to Low</option>
    </select>
  </div>
</form>



{% if results %}
    You searched for: {{query}}
    {% for post in results %}
    <div class="posts-contents">
        <h1>{{post.title}}</h1>
        <p><a href="{% url 'posts:post-detail' post.id %}"><img src="{{post.image.url}}" alt="{{post.title}}"></a></p>
        <p>Price: {{post.price}}</p>
        <p>By <a href="{% url 'posts:profile' post.user.id %}">{{post.user}}</a> on {{post.date|date:"F d, Y"}}</p>
    {% endfor %}
{% else %}
    <h1>No Results found</h1>
{% endif %}

{% endblock %}
<!-- 
{% block script %}
    <script>
      $(function(){
        $('select[name]').change(function(){
        $('.sortingForm').submit(function(event){          
        });
      });
    </script>
{% endblock %} -->